{% extends 'layout.html' %} {% block content %} {% for message in
get_flashed_messages() %}
<div
  id="alert-1"
  class="flex p-4 mb-4 text-green-800 rounded-lg bg-green-200 dark:bg-gray-800 dark:text-blue-400 mt-2.5"
  role="alert"
>
  <svg
    aria-hidden="true"
    class="flex-shrink-0 w-5 h-5"
    fill="currentColor"
    viewBox="0 0 20 20"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      fill-rule="evenodd"
      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
      clip-rule="evenodd"
    ></path>
  </svg>
  <span class="sr-only">Info</span>
  <div class="ml-3 text-sm font-medium">{{message}}</div>
  <button
    type="button"
    class="ml-auto -mx-1.5 -my-1.5 bg-green-50 text-green-500 rounded-lg focus:ring-2 focus:ring-blue-400 p-1.5 hover:bg-green-200 inline-flex h-8 w-8 dark:bg-gray-800 dark:text-blue-400 dark:hover:bg-gray-700"
    data-dismiss-target="#alert-1"
    aria-label="Close"
  >
    <span class="sr-only">Close</span>
    <svg
      aria-hidden="true"
      class="w-5 h-5"
      fill="currentColor"
      viewBox="0 0 20 20"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
        clip-rule="evenodd"
      ></path>
    </svg>
  </button>
</div>
{% endfor %}
<!-- component -->
<section class="text-gray-700 body-font overflow-hidden bg-white">
  <div class="container px-5 py-24 mx-auto">
    <div class="xl:w-4/5 mx-auto flex flex-wrap">
      <img
        alt="ecommerce"
        class="lg:w-1/2 w-full object-cover object-center rounded border border-gray-200"
        src="/static/images/{{product_to_view.image}}"
      />
      <div class="lg:w-1/2 w-full lg:pl-10 lg:py-6 mt-6 lg:mt-0">
        <h2 class="text-sm title-font text-gray-500 tracking-widest">
          {{product_to_view.brand}}
        </h2>
        <h1 class="text-gray-900 text-3xl title-font font-medium mb-1">
          {{product_to_view.name}}
        </h1>
        <div class="flex mb-4">
          <span class="flex items-center">
            <!-- <svg
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              class="w-4 h-4 text-red-500"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
              ></path>
            </svg> -->
            <svg
              fill="currentColor"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              class="w-4 h-4 text-yellow-500"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
              ></path>
            </svg>
            {% if product_to_view.rating_result() == 0 %}
              <span class="ml-1">5.0/5.0</span>
            {% else %}
              <span class="ml-1">{{product_to_view.rating_result()}}/5.0</span>
            {% endif %}

            {% if product_to_view.rating_count == None %}
              <span class="text-gray-600 ml-3">No reviews yet</span>
            
            {% else %}
              <span class="text-gray-600 ml-3">{{product_to_view.rating_count}} Reviews</span>
            {% endif %}
          </span>
          <span class="flex ml-3 pl-3 py-2 border-l-2 border-gray-200">
            <a class="text-gray-500">
              <svg
                fill="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                class="w-5 h-5"
                viewBox="0 0 24 24"
              >
                <path
                  d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"
                ></path>
              </svg>
            </a>
            <a class="ml-2 text-gray-500">
              <svg
                fill="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                class="w-5 h-5"
                viewBox="0 0 24 24"
              >
                <path
                  d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"
                ></path>
              </svg>
            </a>
            <a class="ml-2 text-gray-500">
              <svg
                fill="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                class="w-5 h-5"
                viewBox="0 0 24 24"
              >
                <path
                  d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"
                ></path>
              </svg>
            </a>
          </span>
        </div>
        <p class="leading-relaxed">{{product_to_view.description}}</p>
        <div
          class="flex mt-6 items-center pb-5 border-b-2 border-gray-200 mb-5"
        >
          <div class="flex ml-6 items-center">
            <div class="relative">
              <span
                class="absolute right-0 top-0 h-full w-10 text-center text-gray-600 pointer-events-none flex items-center justify-center"
              >
              </span>
            </div>
          </div>
        </div>
        <div class="flex">
          {% if product_to_view.offered_price %}
          <span
            class="title-font font-medium text-2xl text-gray-500 mr-2 line-through"
            >SGD {{"%.2f"|format(product_to_view.price)}}</span
          >
          <span class="title-font font-medium text-2xl text-gray-500 mr-2"
            >SGD {{"%.2f"|format(product_to_view.offered_price)}}</span
          >
          {% else %}
          <span class="title-font font-medium text-2xl text-gray-500 mr-2"
            >SGD {{"%.2f"|format(product_to_view.price)}}</span
          >
          {% endif %}
          
          <form

            action="{% if current_user.is_authenticated %} 
                      {{url_for('products.add_to_cart', product_id=product_to_view.id)}}
                    {% else %}
                      {{url_for('auth.login')}}
                    {% endif %}"
            method="GET"
          >
            <button
              type="submit"
              name="add_to_cart" class="flex ml-auto text-white bg-teal-600 border-0 py-2 px-6 focus:outline-none hover:bg-teal-700 rounded duration-500"
            >
              Add to Cart
            </button>
          </form>
        </div>
        <div class="mt-2">
          <span class="text-gray-800 italic">*quantity can be changed in cart</span>
        </div>
      </div>
    </div>
  </div>

  <div class="text-center text-gray-800">
    <form action="" method="POST">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
      <p class="text-xl">Leave a rating...</p>
      <input type="radio" name="rating" value="1" required>1<ion-icon name="star-outline"></ion-icon> 
      <input type="radio" name="rating" value="2">2<ion-icon name="star-outline"></ion-icon> 
      <input type="radio" name="rating" value="3">3<ion-icon name="star-outline"></ion-icon> 
      <input type="radio" name="rating" value="4">4<ion-icon name="star-outline"></ion-icon> 
      <input type="radio" name="rating" value="5">5<ion-icon name="star-outline"></ion-icon> 
      <br>
      <input type="submit" name="rating" value="Submit" class="focus:outline-none text-white bg-teal-600 hover:bg-teal-700 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 duration-300 cursor-pointer">
    </form>
  </div>
</section>

<hr class="h-px my-8 bg-gray-200 border-2 dark:bg-gray-700" />

<h2 class="text-3xl font-semibold text-center">Related Products</h2>
<div class="grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 mb-6">
  {% for product in more_product %}
    <div
      class="w-full max-w-xs bg-white border border-gray-300 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 mx-auto mt-8 hover:bg-gray-200 duration-500"
    >
      <a href="{{url_for('products.productPage', id=product.id)}}">
        <img
          class="mx-auto p-8 rounded-t-lg h-64"
          src="/static/images/{{product.image}}"
          alt="product image"
        />
      </a>
      <div class="px-5 pb-5">
        <a
          href="{{url_for('products.productPage', id=product.id)}}"
          class="flex items-center justify-between"
        >
          <h5
            class="text-2xl font-bold tracking-tight text-gray-900 dark:text-white"
          >
            {{product.name}}
          </h5>
        </a>
        <p class="text-sm text-gray-500">{{product.brand}}</p>
        <div class="flex items-center mt-2.5 mb-5">
          <svg
            aria-hidden="true"
            class="w-5 h-5 text-yellow-500"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <title>First star</title>
            <path
              d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"
            ></path>
          </svg>
        {% if product.rating_result() == 0 %}
            <span
            class="bg-green-100 text-green-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 ml-1"
            >5.0/5.0</span
          >

        {% else %}
            <span
              class="bg-green-100 text-green-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 ml-1"
              >{{product.rating_result()}}/5.0</span
            >
        {% endif %}
        </div>
        <div class="items-center justify-between">
          {% if product.offered_price %}
          <span class="text-xl text-gray-500 dark:text-white line-through"
            >SGD{{"%.2f"|format(product.price)}}</span
          >
          <span class="text-xl text-gray-500 dark:text-white"
            >SGD {{"%.2f"|format(product.offered_price)}}</span
          >
          {% else %}
          <span class="text-xl text-gray-500 dark:text-white"
            >SGD {{"%.2f"|format(product.price)}}</span
          >
          {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}
</div>

{% endblock %}
